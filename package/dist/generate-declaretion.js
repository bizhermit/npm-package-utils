"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=require("fs"),path_1=__importDefault(require("path")),generateDeclaretionFile=(e,t=[])=>{const n=JSON.parse((0,fs_1.readFileSync)(path_1.default.join(e,"package.json")).toString()).name;let r="";const a=["node_modules","cli.ts",...t],i=t=>{(0,fs_1.readdirSync)(path_1.default.join(e,"src",t)).forEach((s=>{if(a.indexOf(s)>=0)return;if((0,fs_1.statSync)(path_1.default.join(e,"src",t,s)).isDirectory())return void i(path_1.default.join(t,s));const l=path_1.default.extname(s);if(".ts"!==l)return;if(s.endsWith("d.ts"))return;const o=s.substring(0,s.length-l.length),u=`${path_1.default.join(t,o).replace(/\\/g,"/").replace(/\/\//g,"/")}`,f=(0,fs_1.readFileSync)(path_1.default.join(e,"src",t,s)).toString().match(/export default ([A-Za-z][A-Za-z0-9$_]*)/)?.[1];null!=f&&0!==f.length&&(r.length>0&&(r+="\n"),r+=`declare module "${n}/${u}" {\n  const ${f}: typeof import("./${u}");\n  // tslint:disable-next-line:export-just-namespace\n  export = ${f};\n}`)}))};i(""),(0,fs_1.writeFileSync)(path_1.default.join(e,"src","index.d.ts"),r)};exports.default=generateDeclaretionFile;