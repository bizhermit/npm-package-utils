"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=require("fs"),path_1=__importDefault(require("path")),generateDeclaretionFile=(e,t)=>{const n=JSON.parse((0,fs_1.readFileSync)(path_1.default.join(e,"package.json")).toString()).name;let r="";const a=["node_modules","cli.ts",...t?.ignoreFileNames??[]],i=!0!==t?.quiet,s=t=>{(0,fs_1.readdirSync)(path_1.default.join(e,"src",t)).forEach((o=>{if(a.indexOf(o)>=0)return;if((0,fs_1.statSync)(path_1.default.join(e,"src",t,o)).isDirectory())return void s(path_1.default.join(t,o));const l=path_1.default.extname(o);if(".ts"!==l&&".tsx"!==l)return;if(o.endsWith("d.ts"))return;const u=o.substring(0,o.length-l.length),c=`${path_1.default.join(t,u).replace(/\\/g,"/").replace(/\/\//g,"/")}`,d=(0,fs_1.readFileSync)(path_1.default.join(e,"src",t,o)).toString().match(/export default ([A-Za-z][A-Za-z0-9$_]*)/)?.[1];null!=d&&0!==d.length?(r.length>0&&(r+="\n"),r+=`declare module "${n}/${c}" {\n  const ${d}: typeof import("./${c}");\n  // tslint:disable-next-line:export-just-namespace\n  export = ${d};\n}`,i&&process.stdout.write(`- ${o} >> ${d}\n`)):i&&process.stdout.write(`[skip] ${o}\n`)}))};s(""),(0,fs_1.writeFileSync)(path_1.default.join(e,"src","index.d.ts"),r)};exports.default=generateDeclaretionFile;