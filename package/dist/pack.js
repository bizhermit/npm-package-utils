"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=require("fs"),path_1=__importDefault(require("path")),utils_1=require("./utils"),packNpmPackage=e=>{const t=path_1.default.join(e,"package"),s=JSON.parse((0,fs_1.readFileSync)(path_1.default.join(e,"package.json")).toString()),i=path_1.default.join(e,"src/package.json"),n=JSON.parse((0,fs_1.readFileSync)(i).toString());n.version=s.version||"0.0.0-alpha.0";let a=path_1.default.join(e,"src/index.d.ts");(0,fs_1.existsSync)(a)?((0,fs_1.copyFileSync)(a,path_1.default.join(t,"index.d.ts")),n.types="index.d.ts",(n.files??[]).length>0&&n.files.indexOf("index.d.ts")<0&&n.files.push("index.d.ts")):(a=path_1.default.join(e,"src/dist/index.d.ts"),(0,fs_1.existsSync)(a)&&((0,fs_1.copyFileSync)(a,path_1.default.join(t,"dist/index.d.ts")),n.types="dist/index.d.ts",(n.files??[]).length>0&&n.files.indexOf("dist")<0&&n.files.push("dist"))),(0,fs_1.existsSync)(t)||(0,fs_1.mkdirSync)(t,{recursive:!0}),(0,fs_1.writeFileSync)(i,JSON.stringify((0,utils_1.sortPackageJsonProps)(n),null,2)),(0,fs_1.writeFileSync)(path_1.default.join(t,"package.json"),JSON.stringify((0,utils_1.sortPackageJsonProps)(n),null,2));const f=path_1.default.join(e,"CREDIT");(0,fs_1.existsSync)(f)&&(0,fs_1.copyFileSync)(f,path_1.default.join(t,"CREDIT"));const l=path_1.default.join(e,"LICENSE");(0,fs_1.existsSync)(l)&&(0,fs_1.copyFileSync)(l,path_1.default.join(t,"LICENSE"));const d=path_1.default.join(e,"README.md");(0,fs_1.existsSync)(d)&&(0,fs_1.copyFileSync)(d,path_1.default.join(t,"README.md"))};exports.default=packNpmPackage;